# Constraints file to prevent pip from upgrading critical dependencies
# Used with: pip install --constraint constraints.txt -r requirements.txt

# CRITICAL: PyTorch 2.8.0 STABLE for RTX 5090 (sm_120) support
# PyTorch 2.8.0 with CUDA 12.9 includes sm_120 compiled in (Blackwell support)
# MUST use CUDA 12.9 wheels from torch index (12.6 wheels lack sm_120)
torch==2.8.0
torchvision==0.23.0

# CRITICAL: NumPy 2.x required for PyTorch 2.8+
numpy>=2.0.0,<3.0.0

# CRITICAL: BitsAndBytes 0.48.0 for PyTorch 2.8 compatibility
# Released 2 weeks ago with CUDA 13.0 support, PyTorch 2.3+ compatibility
# No known issues with PyTorch 2.8.0 stable
bitsandbytes==0.48.0

# CRITICAL: accelerate 1.0+ for NumPy 2.x compatibility
accelerate>=1.0.0,<2.0.0

# Scipy 1.13+ for NumPy 2.x compatibility
scipy>=1.13.0,<1.15.0

# Transformers version lock
transformers>=4.38.0,<4.50.0

# NOTE: Triton constraint REMOVED from here
# PyTorch 2.6.0 pins triton==3.2.0 as a dependency
# We install Triton 2.x AFTER PyTorch installation (see Dockerfile)
# This downgrades Triton while keeping PyTorch 2.6.x intact
